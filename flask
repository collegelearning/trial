

<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>File Path Selector with Popup</title>
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    <style>
        /* Modal styles */
        .modal {
            display: none;
            position: fixed;
            z-index: 1;
            left: 0;
            top: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.4);
            justify-content: center;
            align-items: center;
        }

        .modal-content {
            background-color: #fff;
            padding: 20px;
            border-radius: 5px;
            width: 300px;
            text-align: center;
        }

        .modal-header {
            font-size: 18px;
            margin-bottom: 10px;
        }

        .close {
            color: #aaa;
            float: right;
            font-size: 28px;
            font-weight: bold;
        }

        .close:hover,
        .close:focus {
            color: black;
            text-decoration: none;
            cursor: pointer;
        }
    </style>
</head>
<body>
    <button id="choose-file-btn">Choose File</button>

    <!-- The Modal -->
    <div id="fileModal" class="modal">
        <div class="modal-content">
            <span class="close">&times;</span>
            <div class="modal-header">Select a File</div>
            <input type="file" id="file-input" />
            <br><br>
            <label for="sheet-name">Sheet Name:</label>
            <input type="text" id="sheet-name" placeholder="Enter sheet name" />
            <br><br>
            <button id="upload-btn">Upload File</button>
        </div>
    </div>

    <script>
        // Get the modal and close button elements
        var modal = document.getElementById("fileModal");
        var btn = document.getElementById("choose-file-btn");
        var span = document.getElementsByClassName("close")[0];

        // Show the modal when the button is clicked
        btn.onclick = function() {
            modal.style.display = "flex";
        }

        // Close the modal when the close button is clicked
        span.onclick = function() {
            modal.style.display = "none";
        }

        // Close the modal when clicking outside of it
        window.onclick = function(event) {
            if (event.target == modal) {
                modal.style.display = "none";
            }
        }

        // Handle file selection and send to backend
        $('#upload-btn').on('click', function () {
            var filePath = $('#file-input')[0].files[0];
            var sheetName = $('#sheet-name').val();
            
            if (filePath && sheetName) {
                var formData = new FormData();
                formData.append('file', filePath);
                formData.append('sheet_name', sheetName);

                // Send the file and sheet name to the backend via AJAX
                $.ajax({
                    url: '/upload',
                    type: 'POST',
                    data: formData,
                    processData: false,
                    contentType: false,
                    success: function(response) {
                        alert('File uploaded successfully with sheet name: ' + sheetName);
                        modal.style.display = "none"; // Close the modal
                    },
                    error: function(xhr, status, error) {
                        alert('Error: ' + error);
                    }
                });
            } else {
                alert('Please select a file and enter a sheet name.');
            }
        });
    </script>
</body>
</html>


from flask import Flask, request, jsonify

app = Flask(__name__)

@app.route('/upload', methods=['POST'])
def upload_file():
    if 'file' not in request.files:
        return jsonify({'status': 'error', 'message': 'No file part'}), 400

    file = request.files['file']
    sheet_name = request.form.get('sheet_name')

    if file and sheet_name:
        # Process the file and sheet name
        # Save the file (or process it as needed)
        file.save(f'./uploads/{file.filename}')

        # You can use sheet_name as needed, for example, to open a specific sheet from the file
        return jsonify({'status': 'success', 'file_name': file.filename, 'sheet_name': sheet_name}), 200

    return jsonify({'status': 'error', 'message': 'No file selected or sheet name provided'}), 400

if __name__ == '__main__':
    app.run(debug=True)



